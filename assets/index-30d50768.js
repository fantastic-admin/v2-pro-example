import{d as x,r as O,e as o,o as r,f,g as t,w as d,L as p,K as u,h as n,m as w,j as M,i as g,v as E,O as y,E as v,_ as U,q as L}from"./index-17000ae8.js";const q={class:"upload-container"},D={key:1,class:"image"},I={class:"mask"},R={class:"actions"},A=["onClick"],K=["onClick"],P={key:0,class:"el-upload__tip"},T={style:{display:"inline-block"}},F=x({name:"ImageUpload"}),G=x({...F,props:{action:{type:String,required:!0},headers:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},name:{type:String,default:"file"},url:{type:String,default:""},size:{type:Number,default:2},width:{type:Number,default:150},height:{type:Number,default:150},placeholder:{type:String,default:""},notip:{type:Boolean,default:!1},ext:{type:Array,default:()=>["jpg","png","gif","bmp"]}},emits:["update:url","onSuccess"],setup(e,{emit:m}){const h=e,i=O({imageViewerVisible:!1,progress:{preview:"",percent:0}});function _(){i.value.imageViewerVisible=!0}function $(){i.value.imageViewerVisible=!1}function b(){m("update:url","")}const k=s=>{const c=s.name.split(".").at(-1),l=h.ext.includes(c),a=s.size/1024/1024<h.size;return l||v.error(`上传图片只支持 ${h.ext.join(" / ")} 格式！`),a||v.error(`上传图片大小不能超过 ${h.size}MB！`),l&&a&&(i.value.progress.preview=URL.createObjectURL(s)),l&&a},V=s=>{i.value.progress.percent=~~s.percent},C=s=>{i.value.progress.preview="",i.value.progress.percent=0,m("onSuccess",s)};return(s,S)=>{const c=U,l=o("el-icon"),a=o("el-image"),z=o("el-progress"),N=o("el-upload"),j=o("el-alert"),B=o("el-image-viewer");return r(),f("div",q,[t(N,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":k,"on-progress":V,"on-success":C,drag:"",class:"image-upload"},{default:d(()=>[e.url===""?(r(),p(a,{key:0,src:e.url===""?e.placeholder:e.url,style:u(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},{error:d(()=>[n("div",{class:"image-slot",style:u(`width:${e.width}px;height:${e.height}px;`)},[t(l,null,{default:d(()=>[t(c,{name:"i-ep:plus"})]),_:1})],4)]),_:1},8,["src","style"])):(r(),f("div",D,[t(a,{src:e.url,style:u(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),n("div",I,[n("div",R,[n("span",{title:"预览",onClick:w(_,["stop"])},[t(l,null,{default:d(()=>[t(c,{name:"i-ep:zoom-in"})]),_:1})],8,A),n("span",{title:"移除",onClick:w(b,["stop"])},[t(l,null,{default:d(()=>[t(c,{name:"i-ep:delete"})]),_:1})],8,K)])])])),M(n("div",{class:"progress",style:u(`width:${e.width}px;height:${e.height}px;`)},[t(a,{src:g(i).progress.preview,style:u(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),t(z,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:g(i).progress.percent},null,8,["width","percentage"])],4),[[E,e.url===""&&g(i).progress.percent]])]),_:1},8,["headers","action","data","name"]),e.notip?y("",!0):(r(),f("div",P,[n("div",T,[t(j,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),g(i).imageViewerVisible?(r(),p(B,{key:1,"url-list":[e.url],teleported:"",onClose:$},null,8,["url-list"])):y("",!0)])}}});const J=L(G,[["__scopeId","data-v-f39802c5"]]);export{J as _};
