import{_ as ge}from"./index-9a100d82.js";import{d as q,r as L,B as fe,C as P,aa as y,e as u,a2 as he,o as I,f as ve,g as t,h,w as l,l as V,i as o,t as w,m as $,j as E,L as S,v as A,O as T,b_ as z,E as N,S as be,_ as ye,p as Ce,n as ke,q as xe,x as j}from"./index-17000ae8.js";import De from"./index-b7a3d14d.js";import Le from"./index-e73a9411.js";import{u as Ie}from"./usePagination-e0d8e4d1.js";const Ve=k=>(Ce("data-v-b3860ac7"),k=k(),ke(),k),ze={class:"absolute-container"},Ne={class:"page-main"},we={class:"custom-tree-node"},$e=["title"],Ee={class:"code"},Se={class:"actions"},Ue={class:"container"},Re={class:"container"},Be=Ve(()=>h("div",{class:"empty"}," 请在左侧新增或选择一个字典 ",-1)),Me=[Be],Pe=q({name:"PagesExampleDictionary"}),F=q({...Pe,setup(k){const U=L(),n=L({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""}}),{pagination:p,getParams:O,onSizeChange:G,onCurrentChange:H,onSortChange:J}=Ie();p.value.size=20,p.value.sizes=[20,50,100];const K=L(),i=L({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],dialog:{visible:!1,id:""}});function R(){i.value.search.dictionaryId="",y.get("pages_example/dictionary/list",{baseURL:"/mock/"}).then(e=>{n.value.tree=e.data})}fe(()=>{R()}),P(()=>n.value.search,e=>{U.value.filter(e)});function Q(e,a){return e?a.label.includes(e):!0}function B(e){n.value.currentData=e,n.value.dialog.parentId=(e==null?void 0:e.id)??"",n.value.dialog.id="",n.value.dialog.visible=!0}function W(e,a){n.value.currentNode=e,n.value.currentData=a,n.value.dialog.parentId=e.parent.data.id??"",n.value.dialog.id=a.id,n.value.dialog.visible=!0}function X(e,a){z.confirm(`确认删除「${a.label}」吗？`,"确认信息").then(()=>{y.post("pages_example/dictionary/delete",{id:a.id},{baseURL:"/mock/"}).then(()=>{N.success({message:"模拟删除成功",center:!0});const _=e.parent,d=_.data.children||_.data,s=d.findIndex(r=>r.id===a.id);d.splice(s,1),n.value.tree=[...n.value.tree]})})}function Y(e){n.value.currentData?(n.value.currentData.children||(n.value.currentData.children=[]),n.value.currentData.children.push({id:e.id,label:e.label,code:e.code})):n.value.tree.push({id:e.id,label:e.label,code:e.code})}function Z(e,a){if(n.value.currentNode&&n.value.currentData)if((n.value.currentNode.parent.data.id??"")===a)n.value.currentData.label=e.label,n.value.currentData.code=e.code;else{const _=n.value.currentNode.parent,d=_.data.children||_.data,s=d.findIndex(r=>r.id===e.id);if(d[s].label=e.label,d[s].code=e.code,a){const r=(g,x)=>{for(const b in g){if(g[b].id===x)return g[b];if(g[b].children){const D=r(g[b].children,x);if(D)return D}}},v=r(n.value.tree,a);v.children||(v.children=[]),v.children.push(d[s])}else n.value.tree.push(d[s]);d.splice(s,1)}}function ee(e){p.value.page=1,i.value.search.dictionaryId=e.id}P(()=>i.value.search.dictionaryId,()=>{m()});function m(){i.value.loading=!0;const e=O();i.value.search.dictionaryId&&(e.dictionaryId=i.value.search.dictionaryId),i.value.search.title&&(e.title=i.value.search.title),y.get("pages_example/dictionary/item/list",{baseURL:"/mock/",params:e}).then(a=>{i.value.loading=!1,i.value.dataList=a.data.list,i.value.dataList.forEach(_=>{_.enableLoading=!1}),p.value.total=a.data.total})}function te(e){return new Promise(a=>{z.confirm(`确认${e.enable?"禁用":"启用"}「${e.name}」吗？`,"确认信息").then(()=>{e.enableLoading=!0,y.post("pages_example/dictionary/item/change/enable",{id:e.id,enable:!e.enable},{baseURL:"/mock/"}).then(()=>(e.enableLoading=!1,N.success({message:`模拟${e.enable?"禁用":"启用"}成功`,center:!0}),a(!0))).catch(()=>(e.enableLoading=!1,a(!1)))}).catch(()=>a(!1))})}function ae(e){G(e).then(()=>m())}function ne(e=1){H(e).then(()=>m())}function ie({prop:e,order:a}){J(e,a).then(()=>m())}function le(){i.value.dialog.id="",i.value.dialog.visible=!0}function oe(e){i.value.dialog.id=e.id,i.value.dialog.visible=!0}function ce(e){z.confirm(`确认删除「${e.name}」吗？`,"确认信息").then(()=>{y.post("pages_example/dictionary/item/delete",{id:e.id},{baseURL:"/mock/"}).then(()=>{m(),N.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function de(e){z.confirm(`确认删除选中的 ${e.length} 条数据吗？`,"确认信息").then(()=>{y.post("pages_example/dictionary/item/delete/multi",{ids:e.map(a=>a.id)},{baseURL:"/mock/"}).then(()=>{m(),N.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}return(e,a)=>{const _=be,d=u("el-button"),s=ye,r=u("el-icon"),v=u("el-button-group"),g=u("el-input"),x=u("ElTree"),b=u("el-scrollbar"),D=u("el-space"),C=u("el-table-column"),se=u("el-tag"),re=u("el-switch"),ue=u("el-table"),pe=u("el-pagination"),_e=ge,me=he("loading");return I(),ve("div",ze,[t(_,{title:"字典管理",content:"页面数据为 Mock 示例数据，非真实数据。"}),h("div",Ne,[t(_e,{"hide-left-side-toggle":""},{leftSide:l(()=>[t(v,{class:"btns"},{default:l(()=>[t(d,{type:"primary",class:"add",onClick:a[0]||(a[0]=c=>B())},{default:l(()=>[V(" 新增字典 ")]),_:1}),t(d,{onClick:R},{icon:l(()=>[t(r,null,{default:l(()=>[t(s,{name:"i-ep:refresh"})]),_:1})]),_:1})]),_:1}),t(g,{modelValue:o(n).search,"onUpdate:modelValue":a[1]||(a[1]=c=>o(n).search=c),placeholder:"请输入关键词筛选字典",clearable:"",class:"search"},null,8,["modelValue"]),t(b,{class:"tree"},{default:l(()=>[t(x,{ref_key:"dictionaryRef",ref:U,data:o(n).tree,"filter-node-method":Q,"default-expand-all":"",onNodeClick:ee},{default:l(({node:c,data:f})=>[h("div",we,[h("div",{class:"label",title:c.label},w(c.label),9,$e),h("div",Ee,w(f.code),1),h("div",Se,[t(v,null,{default:l(()=>[t(d,{type:"primary",plain:"",size:"default",onClick:$(M=>B(f),["stop"])},{icon:l(()=>[t(r,null,{default:l(()=>[t(s,{name:"i-ep:plus"})]),_:1})]),_:2},1032,["onClick"]),t(d,{type:"info",plain:"",size:"default",onClick:$(M=>W(c,f),["stop"])},{icon:l(()=>[t(r,null,{default:l(()=>[t(s,{name:"i-ep:edit"})]),_:1})]),_:2},1032,["onClick"]),t(d,{type:"danger",plain:"",size:"default",onClick:$(M=>X(c,f),["stop"])},{icon:l(()=>[t(r,null,{default:l(()=>[t(s,{name:"i-ep:delete"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])]),_:1})]),default:l(()=>[E(h("div",Ue,[t(D,{wrap:""},{default:l(()=>[t(d,{type:"primary",onClick:le},{icon:l(()=>[t(r,null,{default:l(()=>[t(s,{name:"i-ep:plus"})]),_:1})]),_:1}),t(d,{type:"danger",disabled:!o(i).selectionDataList.length,onClick:a[2]||(a[2]=c=>de(o(i).selectionDataList))},{icon:l(()=>[t(r,null,{default:l(()=>[t(s,{name:"i-ep:delete"})]),_:1})]),_:1},8,["disabled"]),t(g,{modelValue:o(i).search.title,"onUpdate:modelValue":a[3]||(a[3]=c=>o(i).search.title=c),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),t(d,{onClick:m},{icon:l(()=>[t(r,null,{default:l(()=>[t(s,{name:"i-ep:search"})]),_:1})]),_:1})]),_:1}),E((I(),S(ue,{ref_key:"dictionaryItemRef",ref:K,data:o(i).dataList,border:"",stripe:"","highlight-current-row":"",height:"100%",onSortChange:ie,onSelectionChange:a[4]||(a[4]=c=>o(i).selectionDataList=c)},{default:l(()=>[t(C,{type:"selection",align:"center",fixed:""}),t(C,{prop:"name",label:"名称"}),t(C,{label:"键值",align:"center",width:"150"},{default:l(c=>[t(se,{type:"info"},{default:l(()=>[V(w(c.row.value),1)]),_:2},1024)]),_:1}),t(C,{label:"状态",width:"100",align:"center"},{default:l(c=>[t(re,{modelValue:c.row.enable,"onUpdate:modelValue":f=>c.row.enable=f,loading:c.row.enableLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>te(c.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),t(C,{label:"操作",width:"200",align:"center"},{default:l(c=>[t(d,{type:"primary",size:"small",plain:"",onClick:f=>oe(c.row)},{default:l(()=>[V(" 编辑 ")]),_:2},1032,["onClick"]),t(d,{type:"danger",size:"small",plain:"",onClick:f=>ce(c.row)},{default:l(()=>[V(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,o(i).loading]]),t(pe,{"current-page":o(p).page,total:o(p).total,"page-size":o(p).size,"page-sizes":o(p).sizes,layout:o(p).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ae,onCurrentChange:ne},null,8,["current-page","total","page-size","page-sizes","layout"])],512),[[A,o(i).search.dictionaryId]]),E(h("div",Re,Me,512),[[A,!o(i).search.dictionaryId]])]),_:1}),o(n).dialog.visible?(I(),S(De,{key:0,id:o(n).dialog.id,modelValue:o(n).dialog.visible,"onUpdate:modelValue":a[5]||(a[5]=c=>o(n).dialog.visible=c),"parent-id":o(n).dialog.parentId,tree:o(n).tree,onAddNode:Y,onEditNode:Z},null,8,["id","modelValue","parent-id","tree"])):T("",!0),o(i).dialog.visible?(I(),S(Le,{key:1,id:o(i).dialog.id,modelValue:o(i).dialog.visible,"onUpdate:modelValue":a[6]||(a[6]=c=>o(i).dialog.visible=c),"dictionary-id":o(i).search.dictionaryId,tree:o(n).tree,onSuccess:m},null,8,["id","modelValue","dictionary-id","tree"])):T("",!0)])])}}});typeof j=="function"&&j(F);const Oe=xe(F,[["__scopeId","data-v-b3860ac7"]]);export{Oe as default};
