import{d as ne,c as fe,a as he,y as ve,a5 as _e,F as ge,z as be,Z as me,$ as ye,r as S,a6 as ke,G as Se,C as Z,H as w,B as we,P,a7 as W,a8 as X,e as H,o as h,f as g,h as v,m as U,i as l,g as s,w as i,l as b,t as _,V as Y,O as x,k as N,Q as ee,U as te,J as ae,L as Te,_ as Ce,q as Re}from"./index-17000ae8.js";const ze={class:"container"},Ve={key:0,class:"switch-type"},Be={key:1,class:"tips"},Ie={key:0,class:"tip"},Le={class:"tip"},He={class:"tip"},xe={key:1,class:"tip"},Ee=["onClick","onMouseover"],Me={class:"icon"},$e={class:"info"},De={class:"title"},Ue={class:"breadcrumb"},Ne={class:"path"},Ke=ne({name:"Search"}),Oe=ne({...Ke,setup(je){const{t:T}=fe(),se=he(),p=ve(),le=_e(),oe=ge(),ie=be(),E=me(ye),m=S(!1),M=S(),C=S(""),B=S([]),r=S(-1),K=S(),y=S(),I=S([]);function ue(t){return I.value.push(t)}ke(()=>{I.value=[]});const V=Se(()=>{let t=[];return t=B.value.filter(e=>{let u=!1;return E(e.i18n,e.title).toString().includes(C.value)&&(u=!0),e.path.includes(C.value)&&(u=!0),e.breadcrumb.some(n=>E(n.i18n,n.title).toString().includes(C.value))&&(u=!0),u}),t});Z(()=>m.value,t=>{t?(document.body.classList.add("hidden"),y.value&&(y.value.scrollTop=0),w("up",O),w("down",j),w("enter",F),setTimeout(()=>{K.value.focus()},500)):(document.body.classList.remove("hidden"),w.unbind("up",O),w.unbind("down",j),w.unbind("enter",F),setTimeout(()=>{C.value="",r.value=-1},500))}),Z(()=>V.value,()=>{r.value=-1,J()}),we(()=>{P.on("global-search-toggle",t=>{m.value||$(t),m.value=!m.value}),w("alt+s",t=>{p.settings.navSearch.enable&&p.settings.navSearch.enableHotkeys&&(t.preventDefault(),$(),m.value=!0)}),w("esc",t=>{p.settings.navSearch.enable&&p.settings.navSearch.enableHotkeys&&(t.preventDefault(),m.value=!1)}),$()});function re(t){K.value.focus(),$(t)}function $(t="menu"){switch(M.value=t,B.value=[],t){case"menu":p.settings.app.routeBaseOn!=="filesystem"?le.routes.forEach(e=>{e.children&&q(e.children)}):oe.menus.forEach(e=>{A(e.children)});break;case"tab":de(ie.list);break}}function ce(t){var u;let e=!0;return(u=t.children)!=null&&u.every(n=>{var a;return((a=n.meta)==null?void 0:a.sidebar)===!1})&&(e=!1),e}function q(t,e,u,n){t.forEach(a=>{var d,R,c,o,k,f,z,L,G,Q;if(((d=a.meta)==null?void 0:d.sidebar)!==!1){const D=W(n)||[];a.children&&ce(a)?(D.push({title:(R=a.meta)==null?void 0:R.title,i18n:(c=a.meta)==null?void 0:c.i18n}),q(a.children,X(e,a.path),((o=a.meta)==null?void 0:o.icon)??u,D)):(D.push({title:(k=a.meta)==null?void 0:k.title,i18n:(f=a.meta)==null?void 0:f.i18n}),B.value.push({path:X(e,a.path),icon:((z=a.meta)==null?void 0:z.icon)??u,title:(L=a.meta)==null?void 0:L.title,i18n:(G=a.meta)==null?void 0:G.i18n,link:(Q=a.meta)==null?void 0:Q.link,breadcrumb:D}))}})}function A(t,e,u){t.forEach(n=>{var d,R,c,o,k,f,z,L;const a=W(u)||[];n.children&&n.children.length>0?(a.push({title:(d=n.meta)==null?void 0:d.title,i18n:(R=n.meta)==null?void 0:R.i18n}),A(n.children,((c=n.meta)==null?void 0:c.icon)??e,a)):(a.push({title:(o=n.meta)==null?void 0:o.title,i18n:(k=n.meta)==null?void 0:k.i18n}),B.value.push({icon:((f=n.meta)==null?void 0:f.icon)??e,title:(z=n.meta)==null?void 0:z.title,path:n.path,i18n:(L=n.meta)==null?void 0:L.i18n,breadcrumb:a}))})}function de(t){t.forEach(e=>{B.value.push({icon:e.icon,title:e.title,path:e.fullPath,i18n:e.i18n,breadcrumb:[]})})}function O(){V.value.length&&(r.value-=1,r.value<0&&(r.value=V.value.length-1),J())}function j(){V.value.length&&(r.value+=1,r.value>V.value.length-1&&(r.value=0),J())}function F(){r.value!==-1&&I.value[r.value].click()}function J(){if(y.value){let t=0;if(r.value!==-1){t=y.value.scrollTop;const e=I.value[r.value].offsetTop,u=I.value[r.value].clientHeight,n=y.value.scrollTop,a=y.value.clientHeight;e+u>n+a?t=e+u-a:e<=n&&(t=e)}y.value.scrollTo({top:t})}}function pe(t,e){e?window.open(e,"_blank"):se.push(t)}return(t,e)=>{const u=H("el-radio-button"),n=H("el-radio-group"),a=Ce,d=H("el-icon"),R=H("el-input"),c=H("el-tag");return h(),g("div",{id:"search",class:ae({searching:l(m)}),onClick:e[4]||(e[4]=o=>l(m)&&l(P).emit("global-search-toggle"))},[v("div",ze,[v("div",{class:"search-box",onClick:e[3]||(e[3]=U(()=>{},["stop"]))},[l(p).settings.tabbar.enable?(h(),g("div",Ve,[s(n,{modelValue:l(M),"onUpdate:modelValue":e[0]||(e[0]=o=>Y(M)?M.value=o:null),size:"large",onChange:re},{default:i(()=>[s(u,{label:"menu"},{default:i(()=>[b(_(l(T)("app.search.type.menu")),1)]),_:1}),s(u,{label:"tab"},{default:i(()=>[b(_(l(T)("app.search.type.tab")),1)]),_:1})]),_:1},8,["modelValue"])])):x("",!0),s(R,{ref_key:"searchInputRef",ref:K,modelValue:l(C),"onUpdate:modelValue":e[1]||(e[1]=o=>Y(C)?C.value=o:null),placeholder:l(T)("app.search.input"),clearable:"",onKeydown:[e[2]||(e[2]=N(o=>l(P).emit("global-search-toggle"),["esc"])),N(U(O,["prevent"]),["up"]),N(U(j,["prevent"]),["down"]),N(U(F,["prevent"]),["enter"])]},{prefix:i(()=>[s(d,null,{default:i(()=>[s(a,{name:"i-ep:search"})]),_:1})]),_:1},8,["modelValue","placeholder","onKeydown"]),l(p).mode==="pc"?(h(),g("div",Be,[l(p).settings.navSearch.enableHotkeys?(h(),g("div",Ie,[s(c,{type:"info",size:"large"},{default:i(()=>[b(_(l(p).os==="mac"?"âŒ¥":"Alt")+" + S ",1)]),_:1}),s(c,{type:"info",size:"large"},{default:i(()=>[b(_(l(T)("app.search.alt_s")),1)]),_:1})])):x("",!0),v("div",Le,[s(c,{type:"info",size:"large"},{default:i(()=>[s(d,null,{default:i(()=>[s(a,{name:"i-ant-design:caret-up-filled"})]),_:1})]),_:1}),s(c,{type:"info",size:"large"},{default:i(()=>[s(d,null,{default:i(()=>[s(a,{name:"i-ant-design:caret-down-filled"})]),_:1})]),_:1}),s(c,{type:"info",size:"large"},{default:i(()=>[b(_(l(T)("app.search.up_down")),1)]),_:1})]),v("div",He,[s(c,{type:"info",size:"large"},{default:i(()=>[s(d,null,{default:i(()=>[s(a,{name:"i-ion:md-return-left"})]),_:1})]),_:1}),s(c,{type:"info",size:"large"},{default:i(()=>[b(_(l(T)("app.search.enter")),1)]),_:1})]),l(p).settings.navSearch.enableHotkeys?(h(),g("div",xe,[s(c,{type:"info",size:"large"},{default:i(()=>[b(" ESC ")]),_:1}),s(c,{type:"info",size:"large"},{default:i(()=>[b(_(l(T)("app.search.esc")),1)]),_:1})])):x("",!0)])):x("",!0)]),v("div",{ref_key:"searchResultRef",ref:y,class:"result"},[(h(!0),g(ee,null,te(l(V),(o,k)=>(h(),g("a",{ref_for:!0,ref:ue,key:o.path,class:ae(["item",{actived:k===l(r)}]),onClick:f=>pe(o.path,o.link),onMouseover:f=>r.value=k},[v("div",Me,[o.icon?(h(),Te(d,{key:0},{default:i(()=>[s(a,{name:o.icon},null,8,["name"])]),_:2},1024)):x("",!0)]),v("div",$e,[v("div",De,_(l(E)(o.i18n,o.title)),1),v("div",Ue,[(h(!0),g(ee,null,te(o.breadcrumb,(f,z)=>(h(),g("span",{key:z},[b(_(l(E)(f.i18n,f.title))+" ",1),s(d,null,{default:i(()=>[s(a,{name:"i-ep:arrow-right"})]),_:1})]))),128))]),v("div",Ne,_(o.path),1)])],42,Ee))),128))],512)])],2)}}});const Je=Re(Oe,[["__scopeId","data-v-e1ba618a"]]);export{Je as default};
